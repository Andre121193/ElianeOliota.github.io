<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>APP</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css'>
  <link rel='stylesheet' href='https://cdn.materialdesignicons.com/1.1.34/'>
  <link rel="stylesheet" href="./style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</head>

<body>
  <div id="login-page" class="row">
    <div class="col s12 z-depth-6 card-panel">
      <form class="login-form">
        <div class="row">
        </div>
        <div class="row">
          <div class="input-field col s12">
            <i class="material-icons prefix">mail_outline</i>
            <input class="validate" id="email" type="email">
            <label for="email" data-error="informe um email válido" data-success="right">Email</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12">
            <i class="material-icons prefix">lock_outline</i>
            <input id="password" type="password">
            <label for="password">Senha</label>
          </div>
        </div>

        <div class="row">
          <div class="input-field col s12">
            <a href="#" id="registrar" class="btn waves-effect waves-light col s12">Registrar e entrar</a>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6 m6 l6">
            <p class="margin medium-small"><a href="/login.html">Entrar!</a></p>
          </div>
          <div class="input-field col s6 m6 l6">
            <p class="margin right-align medium-small"><a href="/projeto.html">Detalhes do projeto</a></p>
          </div>
        </div>

      </form>
    </div>
  </div>
</body>
<!-- partial -->
<script src='https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js'></script>
<script>


  $("#registrar").on(
    'click',
    () => {

      let logins = JSON.parse(localStorage.getItem('logins'))
      if (logins == null)
        logins = []
      let usuario = {
        email: $("#email").val(),
        password: $("#password").val()
      }
      if (!usuario.email && !usuario.password) {
        alert("Informe todos os dados")
        return;
      }
      let encontrado = false;
      logins.forEach(login => {
        if (login.email == usuario.email) {
          encontrado = true
          alert("Usuário já existe com este email, altere as informações e tente novamente")

        }
      });

      if (!encontrado) {
        logins.push(usuario)
        localStorage.setItem("usuario", JSON.stringify(usuario))
        localStorage.setItem("logins", JSON.stringify(logins))
        window.location = "/principal.html"

      }




    }
  );


</script>


</body>

</html>